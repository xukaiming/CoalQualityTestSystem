
#include "stdafx.h"
#include "GyfxyRDB.H"
 
INT64	CGyfxyRDB::VREF = 3300000L;//5000000L;
int CGyfxyRDB::TempTable[]={
	0, 	39, 	79,	119,	158,	198,	238,  277, 317, 357,
	397,437,	477,517,	557,	597,	637,  677, 718, 758,
	798,838,	879,919,	960,	1000,	1041,1081,1122,1162,
	1203,1244,1285,1325,1366,1407,1448,1489,1529,1570,
	1611,1652,1693,1734,1776,1817,1858,1899,1940,1981,
	2022,2064,2105,2146,2188,2229,2270,2312,2353,2394,

	2436,2477,2519,2560,2601,2643,2684,2726,2767,2809,
	2850,2892,2933,2975,3016,3058,3100,3141,3183,3224,
	3266,3307,3349,3390,3432,3473,3515,3556,3598,3639,
	3681,3722,3764,3805,3847,3888,3930,3971,4012,4054,
	4095,4137,4178,4219,4261,4302,4343,4384,4426,4467,
	4508,4549,4590,4632,4673,4714,4755,4796,4837,4878,
	4919,4960,5001,5042,5083,5124,5164,5205,5246,5287,	
	5327,5368,5409,5450,5490,5531,5571,5612,5652,5693, 	
	5733,5774,5814,5855,5895,5936,5976,6016,6057,6097,
	6137,6177,6218,6258,6298,6338,6378,6419,6459,6499,
	6539,6579,6619,6659,6699,6739,6779,6819,6859,6899,
	6939,6979,7019,7059,7099,7139,7179,7219,7259,7299,
	7338,7378,7418,7458,7498,7538,7578,7618,7658,7697,
	7737,7777,7817,7857,7897,7937,7977,8017,8057,8097,
	8137,8177,8216,8256,8296,8336,8376,8416,8456,8497,
	8537,8577,8617,8657,8697,8737,8777,8817,8857,8898,
	8938,8978,9018,9058,9099,9139,9179,9220,9260,9300,
	9341,9381,9421,9462,9502,9543,9583,9624,9664,9705,

	9745,9786,9826,9867,9907,9948,9989,10029,10070,10111,

	10151,10192,10233,10274,10315,10355,10396,10437,10478,10519,
	10560,10600,10641,10684,10723,10764,10805,10848,10887,10928,
	10969,11010,11051,11093,11134,11175,11216,11257,11298,11339,
	11381,11422,11463,11504,11545,11587,11628,11669,11711,11752,
	11793,11835,11876,11918,11959,12000,12042,12083,12125,12166,
	12207,12249,12290,12332,12373,12415,12456,12498,12539,12581,
	12623,12664,12706,12747,12789,12831,12872,12914,12955,12997,
	13039,13080,13122,13164,13205,13247,13289,13331,13372,13414,
	13456,13497,13539,13581,13623,13665,13706,13748,13790,13832,
	13874,13915,13957,13999,14041,14083,14125,14167,14208,14250,
	14292,14334,14376,14418,14460,14502,14544,14586,14628,14670,
	14712,14754,14796,14838,14880,14922,14964,15006,15048,15090,
	15132,15174,15216,15258,15300,15342,15394,15426,15468,15510,
	15552,15594,15636,15679,15721,15763,15805,15847,15889,15931,
	15974,16016,16058,16100,16142,16184,16227,16269,16311,16353,
	16395,16438,16480,16522,16564,16607,16649,16691,16733,16776,
	16818,16860,16902,16945,16987,17029,17072,17114,17156,17199,

	17241,17283,17326,17368,17410,17453,17495,17537,17580,17622,
	17664,17707,17749,17792,17834,17876,17919,17961,18004,18046,
	18088,18131,18173,18216,18258,18301,18343,18385,18428,18470,
	18513,18555,18598,18640,18683,18725,18768,18810,18853,18896,
	18938,18980,19023,19065,19108,19150,19193,19235,19278,19320,
	19363,19405,19448,19490,19533,19576,19618,19661,19703,19746,
	19788,19831,19873,19916,19959,20001,20044,20086,20129,20172,
	20214,20257,20299,20342,20385,20427,20470,20512,20555,20598,
	20640,20683,20725,20768,20811,20853,20896,20938,20981,21024,//509

	21066,21109,21152,21194,21237,21280,21322,21365,21407,21450,
	21493,21535,21578,21621,21663,21706,21749,21791,21834,21876,
	21919,21962,22004,22047,22090,22132,22175,22218,22260,22303,
	22346,22388,22431,22473,22516,22559,22601,22644,22687,22729,
	22772,22815,22857,22900,22942,22985,23028,23070,23113,23156,
	23198,23241,23284,23326,23369,23411,23454,23497,23539,23582,
	23624,23667,23710,23752,23795,23837,23880,23923,23965,24008,
	24050,24093,24136,24178,24221,24263,24306,24348,24391,24434,
	24476,24519,24561,24604,24646,24689,24731,24774,24817,24859,
	24902,24944,24987,25029,25072,25114,25157,25199,25242,25284,
	25327,25369,25412,25454,25497,25539,25582,25624,25666,25709,
	25751,25794,25836,25879,25921,25964,26006,26048,26091,26133,
	26176,26218,26260,26303,26345,26387,26430,26472,26515,26557,
	26599,26642,26684,26726,26769,26811,26853,26896,26938,26980,
	27022,27065,27107,27149,27192,27234,27276,27318,27361,27403,
	27445,27487,27529,27572,27614,27656,27698,27740,27783,27825,
	27867,27909,27951,27993,28035,28078,28120,28162,28204,28246,
	28288,28330,28372,28414,28456,28498,28540,28583,28625,28667,
	28709,28751,28793,28835,28877,28919,28961,29002,29044,29086,

	29128,29170,29212,29264,29296,29338,29380,29422,29464,29505,
	29547,29589,29631,29673,29715,29756,29798,29840,29882,29924,
	29965,30007,30049,30091,30132,30174,30216,30257,30299,30341,
	30383,30424,30466,30508,30549,30591,30632,30674,30716,30757,
	30799,30840,30882,30924,30965,31007,31048,31090,31131,31173,
	31214,31256,31297,31339,31380,31422,31463,31504,31546,31587,
	31629,31670,31712,31753,31794,31836,31877,31918,31960,32001,
	32042,32084,32125,32166,32207,32249,32290,32331,32372,32414,
	32455,32496,32537,32578,32619,32661,32702,32743,32784,32825,
	32866,32907,32948,32990,33031,33072,33113,33154,33195,33236,
	33277,33318,33359,33400,33441,33482,33523,33564,33604,33645,//809
	33686,33727,33768,33809,33850,33891,33931,33972,34013,34054,
	34095,34136,34176,34217,34258,34299,34339,34380,34421,34461,
	34502,34543,34583,34624,34665,34705,34746,34787,34827,34868,//839
	34909,34949,34990,35030,35071,35111,35152,35192,35233,35273,
	35314,35354,35395,35435,35476,35516,35557,35597,35637,35678,//859
	35718,35758,35799,35839,35880,35920,35960,36000,36041,36081,
	36121,36162,36202,36242,36282,36323,36363,36403,36443,36483,
	36524,36564,36604,36644,36684,36724,36764,36804,36844,36885,//889
	36925,36965,37005,37045,37085,37125,37165,37205,37245,37285,
	37325,37365,37405,37443,37484,37524,37564,37604,37644,37684,
	37724,37764,37803,37843,37883,37923,37963,38002,38042,38082,
	38122,38162,38201,38241,38281,38320,38360,38400,38439,38478,
	38519,38558,38598,38638,38677,38717,38756,38796,38836,38875,
	38915,38954,38994,39033,39073,39112,39152,39191,39231,39270,
	39310,39349,39388,39428,39467,39507,39546,39585,39625,39664,
	39703,39743,39782,39821,39861,39900,39939,39979,40018,40057,
	40096,40136,40175,40214,40253,40292,40332,40371,40410,40449 ,//980¶È//

	//guest
	40533,40572, 40611,40651,40690,40729,40768,40807,40846,40885,	 //990
	40924,40963,41002,41042,41081,41120,41159,41198,41237,41276	,
	41315,41354,41393,41431,41470,41509,41548,41587,41626,41665,
	41704,41743,41781,41820,41859,41898,41937,41976,42014,42053

}; 


//  Temp2AD
long CGyfxyRDB::TemptoAD(int Temp)
{ 
	long result =1999; 
	if(Temp<sizeof(TempTable)/sizeof(TempTable[0]))
		result = (((double)(0xFFFFFFL<<4))/VREF)*TempTable[Temp]+20;
	return result;
}

double CGyfxyRDB::VolToTemp(double voltage)
{ 
	double temp;	
	int i; 
	double deltaT;
	voltage = voltage*1000L;
	if(voltage<0)
		return 0;
	for(i=0;i<sizeof(TempTable)/sizeof(int);i++)
	{
		if(voltage<TempTable[i])
			break;	
	}
	temp = i-1;  
	if (temp<sizeof(TempTable)/sizeof(int))
	{
		deltaT=(voltage-TempTable[(int)temp])/(TempTable[i]-TempTable[(int)temp]);
		temp += deltaT;
	}
	return temp;
}


double CGyfxyRDB::ADToVol(int ADValue)
{
	return (double)(ADValue)*VREF/(0xFFFFFFL<<4);;
}